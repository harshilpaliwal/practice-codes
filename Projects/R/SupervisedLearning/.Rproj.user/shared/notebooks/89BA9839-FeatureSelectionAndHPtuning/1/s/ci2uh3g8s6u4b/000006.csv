"0","#Create a bar plot comparing the test set (baseball_test) MSE of (a) linear regression with all variables, (b) the best subset selection regression model we created, (c) LASSO with lambda set to 50, and (d) LASSO with cross-validated lambda. As training dataset, use the rows in both the `baseball_train` and `baseball_valid"
"0",""
"0","#1. creating the training set"
"0","training_set_lm <- bind_rows(train_set, validation_set)[, -21]"
"0","training_set_matrix <- model.matrix(Salary ~ ., bind_rows(train_set, validation_set)[, -21])[, -1]"
"0","test_matrix <- model.matrix(Salary ~ ., data = test_set %>% select(-split))[, -1]"
"0",""
"0","#creating prediction models"
"0","lm_allvars <- lm(Salary ~ ., data = training_set_lm)"
"0","y_pred_allvars <- predict(lm_allvars, newdata = test_set)"
"0",""
"0","lm_bestvars <- lm(Salary ~ Years + CAtBat + CHits + PutOuts, data = training_set_lm)"
"0","y_pred_bestvars <- predict(lm_bestvars, newdata = test_set)"
"0",""
"0","lm_lambda50 <- glmnet(x = training_set_matrix,"
"0","                      y = c(train_set$Salary, validation_set$Salary),"
"0","                      lambda = 50)"
"0","y_pred_lambda50 <- as.numeric(predict(lm_lambda50, newx = test_matrix))"
"0",""
"0","lm_bestlambda <- cv.glmnet(x = training_set_matrix,"
"0","                            y = c(train_set$Salary, validation_set$Salary),"
"0","                            nfolds = 15)"
"0","y_pred_bestlambda <- as.numeric(predict(lm_lambda50, newx = test_matrix, s = best_lambda))"
"0",""
"0","#3. calculations MSES"
"0","mse_all <- c("
"0","  mse(test_set$Salary, y_pred_allvars),"
"0","  mse(test_set$Salary, y_pred_bestvars),"
"0","  mse(test_set$Salary, y_pred_lambda50),"
"0","  mse(test_set$Salary, y_pred_bestlambda)"
"0",")"
"0",""
"0","#4. creating bar graph"
"0","tibble(Method = as.factor(c(""lm"", ""subset"", ""lasso"", ""cv_las"")), "
"0","       MSE = mse_all) %>%"
"0","  ggplot(aes(x = Method, y = MSE, fill = Method)) + "
"0","  geom_bar(stat = ""identity"", col = ""black"") + "
"0","  labs(title = ""Comparison of test set MSE for different prediction methods"") +"
"0","  theme(legend.position = ""none"")"
