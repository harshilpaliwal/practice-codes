"0","# Piecewise polynomial regression"
"0","piecewise_cubic_basis <- function(predictor, numberOfSpaces = 1){"
"0","  if(numberOfSpaces == 0)"
"0","    return(poly(predictor, degree = 3, raw + TRUE))"
"0","  "
"0","  cut_predictor <- cut(predictor, breaks = numberOfSpaces+1)"
"0","  out <- matrix(nrow = length(predictor), ncol = 0)"
"0","  "
"0","  for(level in levels(cut_predictor)){"
"0","    tmp <- predictor"
"0","    tmp[cut_predictor != level] <- 0"
"0","    out <- cbind(out, poly(tmp, degrre = 3, raw = TRUE))"
"0","  }"
"0","  "
"0","  out"
"0","}"
"0",""
"0",""
"0",""
"0","pc1_mod <- lm(medv ~ piecewise_cubic_basis(lstat, 1), data = Boston)"
"0","pred_plot(pc1_mod)"
